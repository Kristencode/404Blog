<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Category Dropdown Test</title>
</head>
<body>
  <select id="categoryDropdown">
    <option>Loading categories...</option>
  </select>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const dropdown = document.getElementById("categoryDropdown");

      const allowedCategories = [
        "health",
        "sports",
        "entertainment",
        "food",
        "fashion",
      ];

      if (dropdown) {
        console.log("Dropdown found:", dropdown);

        fetch("https://test.blockfuselabs.com/api/categories")
          .then((response) => response.json())
          .then((result) => {
            console.log("API result:", result);
            const categories = result.data;

            if (Array.isArray(categories)) {
              const filtered = categories.filter((cat) =>
                allowedCategories.includes(cat.slug.toLowerCase())
              );

              console.log("Filtered categories:", filtered);

              if (filtered.length > 0) {
                dropdown.innerHTML = `<option value="">-- Select a Category --</option>`;

                filtered.forEach((category) => {
                  const option = document.createElement("option");
                  option.value = category.slug;
                  option.textContent = category.name;
                  dropdown.appendChild(option);
                });
              } else {
                dropdown.innerHTML = `<option value="">No allowed categories found</option>`;
              }
            } else {
              dropdown.innerHTML = `<option value="">No categories available</option>`;
            }
          })
          .catch((error) => {
            console.error("Error fetching categories:", error);
            dropdown.innerHTML = `<option value="">Failed to load categories</option>`;
          });
      } else {
        console.warn("Dropdown element not found.");
      }
    });
  </script>
</body>
</html>
